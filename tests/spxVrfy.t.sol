// Copyright 2024 RISC Zero, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// SPDX-License-Identifier: Apache-2.0

pragma solidity ^0.8.20;

import {RiscZeroCheats} from "risc0/test/RiscZeroCheats.sol";
import {console2} from "forge-std/console2.sol";
import {Test} from "forge-std/Test.sol";
import {IRiscZeroVerifier} from "risc0/IRiscZeroVerifier.sol";
import {SpxVrfy} from "../contracts/SpxVrfy.sol";
import {Elf} from "./Elf.sol"; // auto-generated contract after running `cargo build`.

contract spxVrfyTest is RiscZeroCheats, Test {
    SpxVrfy public spxVrfy;

    function setUp() public {
        IRiscZeroVerifier verifier = deployRiscZeroVerifier();
        spxVrfy = new SpxVrfy(verifier);
        assertEq(spxVrfy.get(), false);
    }

    function test_SetSig() public {
        bytes memory pk = hex"8FE578F0EBE3898BB580D2E59F80EBE5DA762F4A67682844BF158486B8AD5AD0";
        bytes memory sm = hex"1CB64F43B0B0417CA9FA45D44A8267B66458B8878BB5F01C7E6435EB5137A1DD4C6CE8B9D3CD25871D169771C8B68E05C227A3404E2EC1480DEBD549F3817C46370598923AE05FBC8EDC4D4882E17A5B070E90F2D5CF63C735A95DD5FC399742096E29301C08F6B7B1FCD1C07BA612DE9683735ADC979E7AB86F8CA26434115B22949C6741B447AB8CB9D1C3986B4C0E02201A494801B59B6EA18AABA8C692A0E252A5FCC7B93D4DFE7D6A5E6F140EBA0703F130D35358A98EE9B8D82F407634D04AC0C8C34B675C2A839DB8F750BA6D9FE7113D20303694042FA6A6556A6843CFEBFF82994EE90D0EA5F7A6CC3B9454057F3135354918C028D07DC9D4D7655B6AE6BE59EFF9513A12636E69298A8B23A30D458EA1517773BAF6F31916E50D3271D99822C3EE3E0540FA1F2F39ACD3B0FC6EEA186B79C5BF57114C2702503CDB187B569297A239CB5DF37BE9FDFED256D1E18FD8535FB4482DAF9255F8DFDFE6BA6293751E74ED57044B7916602C4D0C0600B47539112D59A28A6F0E541DED9968EF65C022BFA708F77D35C9B2FA6D09D7F09C299465A053C51804473799F1BFA7DC5A025DF215C57C96A81C2EB25B4B60A95E89A227F69C7F423C143DF73D6F707B5DA297D365F32DCF4830FD8A557DF79C028B1ECF426F51DD0352F60A03908ABB73BC7E8BC77942BA6A0639EB4C07CEFCE9A04CEFB06A7B130B01E6111373C4C44D18096995ADF2A707CE742FEF2480FC744CB7151C6C24BD763C5DD573454D7E6A7650F95C951A0CE85128F8169DE887D6CFCE81904698039F22F2C75EE852EA197B366E35DF74B7AEA5BFA19FF43FEBE243D02065A4C2C00759CC28A5CEF2741992ABDE00E77C9896CE1317E72F5999C316FC8140895FC61F3D3B8CB44CE1235748FB539210C0A570F2A0DC62DC218D409E9D74F83A8DC080D6243974F7131983775E711BB278380E9472F05C29B611CD4983C6DA67802CF714B1664166EC6CEFD96462818DD7D041D83DECC9D87AEFF931A5738351ABD71B0FC1E2E065027592DA24556C1973EA4C1912F60D972237E83575393DB567FD98D7FCEB06E4F11F6846A4949F90CD058EB1C9FAAA6D8BDAA54777AF0F7DB97AB42EC7D15388E0E5DBB8C5EA2DEC1977C4B9358DE87ABD28F2583D2917F8390BF4EB70E26F566BD3B88BF373D085C0E64FA91EB7E33DD19603DA8093D18D00D23A71BEFA6ACBB97C84E3125ED7B4BA17F47B8863528BDECE003EFB552276636E0809A6D4E36FA4D3497B85B104F01D5DCFDFD133D053AF54839D1D8446C76DF3A8534BE6E24AD545D878C13115966B8326BF414AD047076F1B58F41E9D192A84510B288423C6C247740F0597E1C15D36794AE2BBCCDD667C72AD45264ED7DAD6CC9AB05038CB1B8A0439FDB1EC0FD7CEAEA79E10C146DCED7F26910B289E220A9DB94620F33864035694A85497E0D8336E9FB47F9B7E16AE6E71702F29470524F4424CE1E62D5C308523E272D615FDDEE96E6D77E39E26A818519E7425DC12CDE467D9DC3F5BF023B9B8CABBE16884933C889FE376A5733D9F03B4AF534D455E47F540BDFEAB3AA1F627796027228FC8ED8EE8EEED19090356BC10B0E402A608DBB3858E6CDF64D12B423BF5EFE526AC3AB2754B4FFF6A84233FE3670041090DB1C631283D1DDEC3F86D08395586EE18618BF58583086D6BF65C6896BB043D6ABA4330743815FB715A6E0C4FA7BECB0533791AA34F814706F56930229A55F87749CBC74B2FEA38F85D5EBF01CD88E653AD764561D0AA243128728B568C4E30E24D1A803484A48A9B507AE353D6086048137AFFB9F47D887E6D91A0DB68C4C6D0A15BFA15148D4892642327F9437477CB5D34CABD116E92BE599019572024C30B1757C31E197055C9F42935C7FDA3BB763D7FA135C5ED0A4C97288F38E5A531F877CF19AD523C62CDA6B4357CAAF718999BC404F9B9F7030A9C5BA459D9962184D077B201CD3C59A48DF8BB4842D8F8FB7012DB8683E8C9D8227C5A4AEB585013165CF52FCAC0BBA73DEB11D025825DEB33AA4BA31367695B82F9718F9D0691AF43DF37E464D65001167FEC8459FE64E73A4751672F942E7EA295D8D506918CB1EB1F1A99A73D8716A900D92F4C06C3B618FECC854DE2120ACD30DB5DB9462EA343A9D929FFD07F1E53A56453C2FA1E12E15FA871932FF88B592273F6050E7ED1F4CAC5BDD18EEFF12EB53DF90460AF531DE7F7C80240C57F412D73CC3779B9CD2448D3DC0E4C95EAB6C0E53DAE0345A3D3C3026A39BA33D0995F3063C2BC5477F9EF0A97BC2A50DAF72237953434A2F0A00997B8C914BCAACF21B13FEAC3C0E3965CF5799143A1F7F1DE35115C50E76CB15CFF6A77641A0B967B8F261AB6CB85F50A2B7A0C4F579AD1CCC2B1FF981FF0C98D9709C6F9D9050CB149E9FC8FE5FCE6177D2561BAD765215B7002ECED69983CD7071DE91E5563A8DE28317CBE04CC2B539E524B8F1C5601D9622CEDA2A97A2F13C8A9A5DB8DC2C398919E0B5E0DD25A43FC9BBFCEE247602082C7694437081268177B30FABEDCA8AD1E3162F53D04F46D49EE9650A78941E45E6EF3E270BDF587184EC45FDAD1B57B0B0F499C48FEBD2EA69DA7EA36FC64B790C6700B9421CC0815E39E421C3B4BB09F8AFFA2732463E2EC18CFDAD0D65624699F34E8322845E89F63870037E3C787E54E8D978520BEEF6E2BAB9A28150E6BEBA6DE144E3245146F2B29220AA265300859F43DD98FC5F76E4A99D4D79FD525D8590C44D9308E9E2813445219FD0E2950FAECF7FDBE66B7B878A7CDB44BF8251126DD7129BDD430CFE781BD8459D6B92825D18D407727EA329E411CC863C9FC8F841CA0D17474F46D88E9D9C29435BEC2186D0B7633204DBC1CED1DB4F6ACEE29B6FB6210DF46E7BC9CC00E4F3D44A52C9CDF71F362656F0667179C5AA71278068449BC04D44DAE4C298F2D2CA352D92CFA3CBD9CC6851108C11EE28FF9AC83052D557FE5FB804D712115FB35F3562897F5CABF82323E4F1631233143CAF17A870F8784DEEDB4CFA02EDAD72ECDEACD9A06ABC0CFEDDC70D9ED5DA842FFF9893D67C9D2E0E26CFD99B508902D66FD8DA134CEDF527E6E2DB3EBE22B556977DB12267D292BFC5443ABF7B5DB9AC10C656F0E2DD6790D62143F01463E1AB958714560756D10D2CC1A179C640E1FB934BD5ED18D00790AB9802AB3B56C9185DAF0FE4FB26B75E33E8F3923C7CC94E589AE9217C7C871E0F6503E3951709C1C0CCD47E779C3BAAB0CFF7127988C2958DD2861FA2EABBE9C712B488429C434BA481D59C27241DE7F30A35C9F46DA6D5A7738E207D253017CF5ADD446C2C55B1C48426694B2F441C3840A5B7475325B85A163B01381349537D5507ACDBBC09F32B124A345F8D4559B66AADB2009FDD3C2A8459C18A2395D6CC6C3A5CA63D303A33DC8E08A728841A1C9CF63F0D4DC962467D88000B374F9AB3852986907586B2E4084B28AF30F21A0F385257EF08C5E86D21534DFF4527F54BE443CD77712B50177C58671CFA1BCD9B2617FCAAA92B46E8C57661FA4BD0AB3EBCCE5DAE6FAE11F471F8DB34E8E33BA18107BF677E2E7BFA8E75E4C04C2D9473A7133CEEB585AAF27CC3082982DBF654BD7096E41EC17EC9633535DAE81D6AD85F7B7EA4B47FDF94A5AF416E17FF9E5885625A195323D09E19BBC10CB337DE2056DC261B706B2296FF4E1282903F0CA0DFD750FC716600A0DE69EBDD3B85FEF33C866151A966C0D1FAA81BA35BC989D82B9184062BB5A9727F030FB77073629A99202A636AD62848B528092E881B97C948F24354D305D5DD540923536C1991BAEF42237247BAB9F004E2859B7B29D6EC99774FE5C5FB429A76BEC7871846F5EFC1A069FFC4BAF34A4E0EF057029CD589E6E5FB2384286A291FDE34D7B4464362552BE2348DAD608A72D57484A5C25765041FDFD0193D0BA5745F6C9E11964F6B5B358068D2DFFBD8B93DF7F620ECF6AF592FAF1B895A579F4E70EAF67E78B2C723BB698A2A8BEE444773BADF735B6D2C2B9D3A90EFD3AE03C37FBE6BDC7CDB1BCAF6A65EEF659764BB6128996B8332490C61A75C642A88E04A2067DACB31FA0EDA96E5326483AC833AB9CD5355B4F221185E5FC3C26AF222763D34751BDD7E67C03AC2E5B03284FFAF3EFCEE6B3E0E51D963A1A2BAAD02DE2E0DBF0D3FA35C85BC59F850DF1A7E2486A97585A6BED73599F2B3513539538F8A708AFE0C06CCC7D65DC55AC432B24893800B8B80564B556DCF75D2D776A94E59FBBD27BA012D74DF8523ED3CF77471270073C1C33CB8E315EE0AB956B2F85B5FDA5C1C95D8393389F23A48B2EDF254B615426E6C73FAE20DDB5F090916BDB153781A7606212C17B13CB2A0E16A8C82D8EE652934DBFBB575FC901DC4B0EC7D0D65DF32F10081928A495C062BDE029ECB6D53EA4E042EC119962C055E368694D5F5358033A1A0D95A68C2FFD09F6D2732FEF1AD03630D0B5CD835ECF72094B045F9107A64A79506ECE0BF95FD6309EDBD92059DE2706C2CF2BC53AC9D88DEE6CD2D61DAD02D37DED8BA4623451D5AFB5C6DDEBE37C3D9FCF39476242CE08D9662127FEB527EFFDF9FE8560A885DFDD610FC65B25E13313B5FD9F6EE07B67B654859AAAE72987CB1AACE36477F7D6FC7D2F03D2A10A6F35461935EDF45BFF78751D9E39F271B96433EDDD82087988073FCD7509D78CA6B4171AA4E24A3ED3B2A44002B9469EEB8548ED8D83619740EDCCC24FC2536F8DEB75AD0DBCA03635F03E4787DFE553D8425185E2363C885E973AFA9765EC665B2792EE780105491EBE4DBC5FBC9231BA043292D5B54882D7F5EA61210228C14400EB449C8929B390CB90B71CA02A57038BDA8B71D7894A915E5764AB8C6254E645D8C427AE5FD066BA6CC83CC52BE7EEA0339543075EA73B4597A7FAF963F477A1C44AA7156CE5C503E312EE3239F6ED62C2C5C39445564BFA45999E776F48DB98D8752C5130831603FC055EB0A1B7249FA6D06E5D835D163FF71BF2F8119A8B6A97A453CC2A35285ED5768B3B4B94D34E35B018EA764CA73B0CAF6C40DAD67A8471EB698E71491271A9A2AEDAFF15BC88D61638C79DAA19FC13BCA335466257C080C9C5DEF9184DAEBB753ECB07BEB6BF4E93A0242CA804D5A0C4541A845A7CAF837453F61C6CB3DF0F018632A9FF217E15860456D8E6E03A0E825D181BE14C556418766C5A4ACB1F560EAF238DA1D89010A0A8F24C9FEE1218E3F12382AC68D4256B623793A44D2D148CA74EF2E27CF842BC641365E6A31E2A8D2930F6AD27901341E455824EBBA1857E1BB398530BA271A45E350F291DAB12A20358011AE1020CF053C4B9AF2F41863A9B551C9C7D483A271A0F28538EA0786792BF9FA70D286B56FD7EA3B525A22D9DB284C9AE575237A5EBCF53CB828F36CF2F7B890CA492091FB809FE3DC82B0B5643EDB1BA888D905367DF1C97CE02025A4CAF5A0B00771739F748AECAB758EB583378E7770A67BBE9EA850DB640A76E3B479393E8465B88C96270EBBDE77423C7A72DB178D458C2A9056AA28D6FBFB57B805475B1998CC781027D1835FF7BD9DED1D1E00F964FE63EA28DCB50981C8B442CD27C2750A424CEEFD043AFB09824010C1C735777018CB62BC1BD2671C659978FECF9851A0E2C1FA24D4A8DDFBA138ED9F973EC24B5D45F966DE9B9A9A24013E22A9A153BD24917C2B4836C71D760C7CD2474CE0E203695549B0CAB3A3E201ACDB21AB507ABE50C55ECEEFA9E517FFE91155FACF87EE52F3EBC38A0055BA6D5F6983D7956410C8D7B3D924A04A892DF7F46F36CAC7332FBD9130CECFA4C0B834B41BE6C85E1B5631EBD935E5495C65A1468FCBEE6CF9555A4F1AB5B262A792717042F971B080FA2FD4F82068553291B0E3A7AD48D84473E2789EF8C691396E4952056BF38763F14D675299AF49FE5A68AF0F77BE5F78BBEFEF3391DC8A8F37B857A9A900836D5149DBADF0690F3A7EED74E832178D34AAFB6B57B87DE8E76BA723D8236062F895DF0753F5253CE7D055C74420E6DCC92D83D3582F01DEF68C958F4B593419A445C84D0A63A0A6BC6748E5EF24E53BCA2BEF286AFD475782F0EFFA25EC59D387FE44DCAACAA2C2CD1FAEB91CA60B20D6B3841ACF2BA63142DCA6652F001D403F74A94FA8E51BE1109329900E2C2483EEBB327A1F923B5F4063954A8915BB2C3BC35393AF975C3D78B8FA393989E8DDE9A9266E2DBD50891C2950A58C7D53ABFEED32883207917B794634242A5EBE3E4CB975C72B7786300725FE56AB5B6CFD7E85734C473AAC2AD3017C84FE328B5B0F004A703CE24A972DAD49F410D33FBE434C8017C007FBACE00162CBDE60C37549D58EEE1B82D41E18799F7002D3020D6D6FE449B3C20F05C99C5DDDBBC7A923044D3D2534157109315E6FA5F78802C4276403F61FFDBDACE03271A4D652E39044D7E4B941E0849D28ADB84C4A02ED229EB31C4573377BCCA063D691528B0586AD57E0E42644A0D9C08FCB0C5A84FC1DDCA16FB7FEA148DFDB1D978C5D00C86C4BC7AD164C8AAA3D3AA2E0310194B37BB7BF646F90DB1667F269E14387C252E17CB3FD07F420D655FB74DD50D5E75D2BB52E0ED7AAE72A3F65E44B7FD90B86BC469D546EC0EA500B56FE7612FF40095AA3B7E588FBBA73E20D94BFF92E95A728458C6204CD195CA3763ED35018486551C3BDC61E187084582B3CEEB49D2CA6BD15D6D9C29245AAE53B4F003AFD59F20A0158C516296BE85FEE8CB9113FAF5A2E30C2112B4AA798ECAC9B029DFE20151D6FFC4BA581DB8912476E30866A249118D037AE4933B6D7ACE4A862D0DD8525E0B17BF844B4CDE57F47F41846ABCDAC45246736F872D0068EDE1D921D1D29D66CAA549ABC761224C6136B1A476F688B04A55295480FA02E9DF9010CCBE58928A989AAA6E8E275FEAF965FB1500ADD61F1165B06D79BCF40D17836D7CC1965459CF9261F095853F98ED3044A580A933FD4451E51585E38E0B0794C36148808D0E45202B901AFADB5AB4A97C8200FF88DC642305182D54D0A57463846A3E456B1D808B2F7678590224852D045D02D5C652831A95222A0159B7B3D9C2E39D2218B04AB5321B619DE173DACAFB90BEF84B8BB8E228E32A8D4DB260B74DBF8D503A9FDEF1DAF8294B9A17554A6E738DBB33F90AA4D98518F56993B2F02822F44F26216BE93913658318169A520F0A5E4757855D7B16FF2B881F82E9FC1573B31B72EA74B761614DD81CA6E4F20D0439A625772E5AB7C745E490C147CEE3480C4E68390153916682DF1517CD6B5F8E76B4FFC8DF120407250C3E1DADFB0C4364BFE521988FE8691782DC42DF7A47376400551DF1776522A8B64F4E783AFB127875807A1229C7CF272D18847DBCD59375D4EEA50C9C46361AE5F5EE1D7E59304EA99A734581ABE798F0AE900CFF7F2050227F722BED6434E1BA6F94333826D14018592F716925D6768D2FCE8C19C8019F77677E7A00AD8DD74D77FE4B770AF0732789385AA43A687CF6ECC060903504C406ECC16E31C0EDE41F3D824BC1011705528AE5F4560D6ED9CA9BC0C4B69E4E6B6E3DF5274D3F352B17C0ACCAC966008D0858DF1C24203637130B544087FB253390476EDA89B1F8B1646741C9272021090425CE7A44D726A7AE9C60DDFC54998E8CAD23D9A71513DFA4F38D12460C5B536F24923F9D1EC9AC882EF67250411B4EA31CE26D26EC63939B0A58B7F47665A2C97ADA4CB006433421834048931F17895CB13BA26EB245ED6F1AF2AD9F6EAD06788D2098DA0BED5FD3B54779E6220AFFDCE08FC9E47BA5725570C9FA938F197DD056F5473360A6900A930E8C7B1805D1CC8B11FFEAB9258EEE036F59FBB2178C5F8D2D0F954EA1D61F198EB8CA99397083CAC0B7E921E18603B6438A345DB9F9C54350449AC6F90FD78473B18D10C21AC4D3D06968640BE956E5CF2F2A380D70DAD5B1AD21BE4863AAF03171FD99362308E5BDA3F8206983DB6BC78857CF20D76AFCDDA5E9D0B7D3ABA15E086D6819A6FEAADC7CBE2D5642ABAEE8504EA4BEE7312DBC4DEA35835B24BFD68A42DD32E80F60ADD66921CDFCD7A52D90FD1183A4BF1D2065CD500BD0E440B887B210A5717B7669DE5E218D0968DD866A289AC4D470CF68823791A198E1CF19A4251CB89144007B08E56252B3AF5EC5B09C6F7A7C54A20B344BADE25D55310F0CF6A5DB8303E9E60FA5D3B3F127009AD4EEEF658B49D25C738CFC266ADE4F91E8AADC961DD87F60F1767BC629F687D6690453C0D2AAB4DAF8E5ABBF684A9227221DE645DAFF8F0833A87DE8B1FAB53E802C94110CF670D8ED40BFC6FC96713F2D73839159EF5378C6111BDFF65F2638CC7D6B7C8D12A42BC56FA0941B84456E9547D684CE4C6FB5042F6721C9C1CE3615C014E41DD1401CA69A31B080BB2B961067973846FBA36EE864E14B97D633D76BE6208832579190DEF1B403A8C6201C554776727F75DF0BB507817DC998EF31BACC71AB5E3940CAE1652F64DC197279E51373B326384CC7CF57F20609317A62F75B0343EF48B4DC4278BD1CD2214640DCB7EB8A185A0B9AC14EDDF6FF015CFF4D9BC3941FD17EB448AC3595B3DE337044431EA3D935CC22F248D3A06B9D833C4E40852DDC8125EDE164F43B7B59A460A535D49FA8017B592E9222D1CFADA101A14E53E949827AB8828B6DA9892723728F26F4C9C3F56C713C213208D482B532D9EEBC789FDCA455877C647A896074DCA8A4C79FDA9451F136016755D2BD3AB46D63008ECF1DE770689575F24AADCAC2F6BEE9EF9AEFB48C2C071E127796302C158345C832791AB8D7421668B8BD21584ABCAEB2CE2385D94FAB1479D60A6FF30820C893B5748059A3484D82601D8BBF4FCD942B6331B48D9F1812AAF6CBBF0EC7DD6028A7BA0FDE5EBFCE3441DA35ED357D0C834675528800A6E2149C2D2966AA0701D71017EBF3BA7AC53290D7BAA92833A21CC2F722C5EF0B64BDF30DF34F088639A79972757682E6E8710961F3516C2F0408F6C783AF881F7106C399BCB090283AC582A4113C2BCE159D6A6F4081399406D0A1856D548BFFE6C45034A9F24E7539DC03E1DCC2528BE71B11E5A6FEF3E1CF4040EB06C967BBF8B64625A3922C5569DFC58D8C9442EA6324DDF12320DB4D738A5446B76CEEBEA0C42C1FE78E7A11BD57AE7242D277C516C97CED18A2809C8C1A836E14BC8E7E91F4727E2074550B3E7EA7566C95F0B2FE263C3D43F5AB3D391163756E0913456A66B86CF585EF4A60D98D4AA5948670063AC2B4368F4077EB457BC8ED5F0A63BAA4CEED9182FB461B4329D2D6DCACB503B0F9BBEC490A67B3A80208F5E82B2B5D98573174C0B79BEDE92078896C7E420CC679AB20E920DC941989A3F3238EDA84E9539167B8FAD1DAE33657B8D29E8D4F206B4750EE05DFAA1C42B3FBDDF77FB546EA15AB19B58A824BA4F970F8DE84C3D2523658D68BB9E6044D36209810F1FF04702D4B81F35B497CD9AC231D6BFEE39824CFB153D4319E05097FF89C037B79BA54FEAE59107F307F43B020F684BF235CD92DCBEC100B1E1D9361CC91FD483FE4C84DC855B1556BCFCAEA3E1FA7CE323A2463E2482803812B66617F21C09CA8667925EF9CAB581AAB97B141397D43809F241062E7BB8D10E63C69CD05C420BD70FB9797D0CE3B2ADF48BEF18D46155B9B61047D077EBD2473B3853ABC95F9DE309276B8F51B673C8DC6AA7A76B4B21EA63FF202A735EC9923A14B45AEC14E3A5D0FC189D44BC4FEA9ECB36A0F06DB0E9A05444B6ABB33091FBC06A9B05068D99EFE2791D1AD95987BC8D00F041E7BDD125F323F1404714C4A8FD6C897B70FB23D093C2D67D9BE29D4BEA8E672FB28E1303CC9B0458DF8815DA743AF6DCFD701A6AC6C058F24565CF4CA8B7C42F7DF7A11340B44DF7E7230466D2BF5D75B859884AFD690ED5E7BD31BAD55C4E483ECB3CF6823F704D929A1BD8949A8493A85F5CA1C303CCE755641B33EEFF3838E35B757C4D396F830B39B7DB91E67C0DF9012CF0D926E121F21504621FD4708D0FAB6B1BDDA21887234FD38B7EE9C67C79A78C7B00D4862FB9FDC843FF83772E54BECF3640C243D652419BACEB8AA6ADF7DC7649F699DFC86786AFF9CD13C5FA45DDBC2AC03F57A0A5B5E55098CCA57CBAFB8BF38E336F4519002523C4994D1D2582B010FFF0E9E8201AD1122F2D0A37449057EB13923F5BC649788690FB2B9BA111D39BD22CB57FF3A3F601B8539AC5F71D5EA0A8DF82832ADA66988E09035E919146243615752C3AA634F94163762531D91ECCC084B5EDF1C64CC800877FE5C5BCD1AC49986B983C17BA90795C8778D7B6097CA4A760B5B713C15888247CEB1503D66C5D0BC7840E24175B71BBFE6E502FAC209109B8F37FAF6B78AF75AAA62D9AE23A82258AA449E310930AE849F4FA1980621C381D43B7551321880BB43F161D5B85597D3BCF13C7099017A5042B172BFCC7E542C5E0F7C3BE260F3F6D1C8251239E18837411939996B2F1CBB29107D51C2598B2EA845B368AE829F80A60C0E0F2A821834A8BD19F2CBC2FC146E7CB7301F4C85B8C5748C8F275AF431D57A2A46C8AB09E359CD2F57144087BCA1F324E899C17E5E28B380D806163BAF6FD644A7523FA0A9B94E47546AEB974C3BDB00363CABE505A9674FE358353A30560B3EB7D6215819F65DA054048DCFCF366A7C82600EEDF12A7D9423DEDB81AE1EE573E074ECCE53F2CD148C82593516CA42E0A6DECAC795440AB599C843C88E13D441AEAD436FAE512E00BAE906A209F2217219BE4E0200D136BE8804B0541F821A27BF28998E5AE566FA247F4FC23ACFD7573E032515A93531598A327A0516DE288A20A3364E226A53EFB161511C300744F11E4411C3BB9672DEAB098614B6DBCC60EB8AA3B0762F667E83740DBD69AE7B7ABA213EDA88B1DE22F81A41F333B1C192F1E0DD7C0983EE09C220D5B9E9083A5DEC5A9F22CC3062120EF9B9447C3936DAAA4FA98174193AE2107B83E0561E86BDC3A4B3FF68CB5E12DFB8E71594E154DCC025BFFB96CCA228661EFC31F015ED12FB9D214540EDCFE488388EE395B64A2A8C15F8E98068656C6C6F776F726C6400";
        bytes memory input = bytes.concat(pk, sm);
        
        // 调用 zkVM guest 执行签名验证
        (bytes memory journal, bytes memory seal) = prove(Elf.SPXVRFY_PATH, abi.encode(input));
 
        // 解析 journal 获取 guest 输出的 bool 值
        bool isValid = abi.decode(journal, (bool));
        assertTrue(isValid);

        spxVrfy.set(seal);
        assertTrue(spxVrfy.get());
    }
}
